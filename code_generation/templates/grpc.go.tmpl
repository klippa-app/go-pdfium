// Code generated by tool. DO NOT EDIT.
// See the code_generation package.

package commons

import (
	"fmt"

	"github.com/klippa-app/go-pdfium/requests"
	"github.com/klippa-app/go-pdfium/responses"
)

type Pdfium interface {
	Ping() (string, error)
{{- range $method := .Methods }}
	{{ $method.Name }}(*requests.{{ $method.Input }}) (*responses.{{ $method.Output }}, error)
{{- end }}
	Close() error
}
{{ range $method := .Methods }}
func (g *PdfiumRPC) {{ $method.Name }}(request *requests.{{ $method.Input }}) (*responses.{{ $method.Output }}, error) {
	resp := &responses.{{ $method.Output }}{}
	err := g.client.Call("Plugin.{{ $method.Name }}", request, resp)
	if err != nil {
		return nil, err
	}
{{ if eq $method.ImplementsAfterUnmarshaler true }}
	any(resp).(responses.AfterUnmarshaler).AfterUnmarshal()
{{ end }}
	return resp, nil
}
{{ end -}}
{{ range $method := .Methods }}
func (s *PdfiumRPCServer) {{ $method.Name }}(request *requests.{{ $method.Input }}, resp *responses.{{ $method.Output }}) (err error) {
	defer func() {
		if panicError := recover(); panicError != nil {
			err = fmt.Errorf("panic occurred in %s: %v", "{{ $method.Name }}", panicError)
		}
	}()

	implResp, err := s.Impl.{{ $method.Name }}(request)
	if err != nil {
		return err
	}

	// Overwrite the target address of resp to the target address of implResp.
	*resp = *implResp

	return nil
}
{{ end -}}